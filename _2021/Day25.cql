CREATE CONSTRAINT grid_pos_key IF NOT EXISTS
 FOR (n:Posi)
 REQUIRE n.pos IS NODE KEY;
MATCH (n)
DETACH DELETE n;
WITH split('..>>v>vv.. ..v.>>vv.. ..>>v>>vv. ..>>>>>vv. v......>vv v>v....>>v vvv....>.> >vv......> .>v.vv.v..',' ') AS lines
// WITH split('>vv...v..>.v>.>v...>>>>vv...v.>..>..>>v>v....v..>>.>v...v...>.>..v>.>>..>.>v.v...>v>v.>v..vv>>>..>....v.v.>.v.......v>....vv..>.>vv>v>>>.>. >.>..>>........v....>...v.v.>.v>v.v...........>..>>vv...v.v.v>>...v>>v>...>v...>>v....v.>.>>.>vv..>...>...v.>.........>.vvv.v.>.>>>..>..>v. .v.v>v.v.v.>.>>>v.>>.v.>v..>.v.vv.....>.>v.>>.>..>.v.vv>....>.v>.v.....>.vvv.>>v.>.>.v...v....>vv>.v...v.v...v>vvvv.>v>>>.v>v>...>.v..>.... >.v.>v>...vv.>...v.>..>.....>>..vvv..v.>>>...>v.v.v>.v..vv...v>.>.>vv......v....v>vvv>.vv.>..>>>...v..vvv..>v>>v>.v.v..>v.>vvv.>v.v....>.v> ...v.v>v......v>.v.v>>>.v>vvv..v>v...v.v.v>..>...>.>vvvvv..>vvvvv>.>>...v.v>>>..vvv....vv...>vv.v.v.v.v.v>.v..vvv>>..>>v.>..vv.>vv>..>vv>.. .>....v...>>..>>>>>>v.v.vvv>.>..>...v..>....>.v.>.vv.....>..>>v.vvv...>.>>v>v.>.>....>.v>.vvv..v>.>>....>vv....>>.v.>..>v>>...v...v.>..v.>v .v..vvvv.v..v..>....v>..>v>.v.>...>v..>..>vv>>>...v..>vv..>v.v>>..v....v>.>.v>..>vv.>>.>..v>.>v.vv.>...vvv..>v.v>v>>v>vv.v..vv>.>>..>.>.... .>..>>.v>..v.vv>.v....>v>v.v>.>v.vvv>v.....v.>>...vv>v..v...>>>>..vvv>v.v.vvv>v....>>v..vv...vv....>>>.v.vv.vv..v>v.>>v.......>.v.>v>...v>v vv..>>....vvv..v..>v..>>..v...>...>>v>>>..vv..v>>.vv..>.>.v>.>.v...>>v.>..>>v.v...>>vvv.v.>..>.v.v.>vv>....>..>v...vv......>v>....>.>.v>>.. >>>.v>.v>vv..vv>vvv>>....>>>v.v..>..v>v..>vv.v.>>..v>>vvvv.>..v>.v>.>..vvv....v..>....>v.v.>v..v>>>...v>...>...v..>v>.>v>...>.v.>v>>>>>v>>v ...v...>>.v..vvv.v..>v....v>vv.>......v>.v.vv.>vvv>..>.v>vv>...>>.>.v....>v.v..>.>.>>.>v>.>...>v>vv>..>vvv....v..>..>>v.v.v.>>..v....>.>.>v .>.v>.v>vvvvv.>>>.....v.>>v...v..>.>.>>>.>.v>...>vv>....>..vvv>vv.v.>>....>>..vv>>v.>...v.v.>>v.>...>v>...>v.>vvv...>.>.>vv....>>>..>.v>..v .........>>v.>.v.>....v..v>...>..vv.....vv>v>..v.v......>v..v>>.>..>.>..>...>>.v>.vv.>.>..v.>.>v>v.>v>.>>v.v>.>vv.>>v.v.....v.v.>>vv.v.v.vv ...>v>.>.>>.v>...>..>v.>>>.>>>>>v..>...v....>..>...>>..>vv....>.>>..>v....>v>>.v...v.>..v>v>.>.>v>>>v..v.......>...>....v..v>v.v.vv.vv.v... v..>..v.v..v>...vvv.v.>.vvv.v>.....v.>>v>.>>>.v....>..v>....>.....>..v>..v>>.>.>>v..vv...vvvvv.>>...v..>.>>v.v..>vv......v>>>.>>.vv>...>v.. ...>..v>..>..v>>vv..>.>.v>v..>>>.>..vv.>.v..v.vv.>.v.>>.v.>>v.v......v....v..v.v>.>v.v....>>>.v...v.>..v.v.v.>>v.v..v>>>v>vv>.....>v...vv>> ....>..v..>...v..>v...v.>.v.>.vv>.>>....>..>v>v.>....>>.>v>v...>>..>v.v>...>v.v.v..>>......v.v..v>vv.>>>v>v.v.vv..v.v.v.v..>....v.v>v>.v>v. ..>vv.v..>.v>..v..v>>.v.>vv...vv>.vvv.>>>.....v..>>>.v.v...v>>.vv..>..v.>>.v.......>>....>>.>>........>.>.>.v.>..v....>vv>v.>.>vv>v.>vvvv>. >.>>...>.v.>...>...vv...>.>.v.>.>..v.vv.>>.>v>.v>...v.v>>.>v..>....v.>..v>..>>...v.v.>v...vv...>v>v.v........v.vv.>.v.>...v>>v>v..v>......v .>.>.v.>..>>.>.v....v..>v.v>.>>.>>.>.>v..vv.v..............v.>v.>.v.>>.......>>>vvv>.>>v..>.v>>..v>.>..v>....vv.>vv.vv.v.>..>..v>>v.v..>..> ..>>.>.v>.....v.>v>.>vv>>..>...vv.>.>.>>v>.....>..>..>.vv>v..>..v>>.v..>vvv.>v>v>...>>v.>v>..>..>...>.>>>..>.v>.v.v.>..v....>v...>>v.vv..v. >....>...>..>v>v.v...vv.v>v>.>..>>vv>...vv...>..vvv...vvv..>...v>>.>.>.vvvv.>v.>...>.v.>v>.>>..vv>.vv..v>vvv.>>..>.>...>.vvvvvvv..v..>...>. >.vv>.>>.v......>.v..v.>..>.>.vv....v>v....>vv>>......>..>.>.>v.>v...>.v.>>v.>.>...>.....v.>>vvv....>..v..v>>...>.>>>....>>>>v.>v>.>>>..>>. ...vv>v.>.v>.vvv...v.>>.>..v.v.vv..>.v>>.>.v...>>v>.>>>.>>.v...v......>.>>.>..v...vv.>v>.v.v.>v>>..v>...v...>v..>v>>.v....v..v..vv..v>v>>>. >vv...>..v...v.>v>>.v..vv>..>v>vvv....v>vvv......v>v..>vv..>.v.v.>v.v.v.v>..v.>.>....>..>...>....>.>....>v>v.>>v..vv.>.v>vvv...v.v..v.>v.v> >vv.>......>..>>v.>...v...>..v.......>.>v>..>>.>v>...v.>v.>vv.>.v..>v..>v...>.v>>...vv>..vv..v.......>.>....v.>>vv.v..>.>......>.v.....vv.> ......vv.>v>v.vvvv.v>.v.>....v>>..v..>...v.>...v>>....>.>..v.>.>.>v.....>v>vv>..vv>v.....v.>>v.v.>.>..>..>...>v....v>>vvv..v.>>.v.>.v....vv v...v...v>>>v.v.>v.>>..>...v..v...vv..v..v.v.>.v>v.>>v.v>..v.>v>v>......vvv>v>v>.>v.vv.>v...v>>>.vvv.vv>v..v..v.vv.v.vv.>.>...vvv.v..v...>. >...>vvv>.>v>>v.vvv.........>>..v..>.>>.vvv>.v.....v.....>..v...v.>>>v>...>.v..v>v..v.>>.v.>.....vv>v...vvvv.>vv>>>..>>.v>..vv.v..v.>..>..> >....v......v>..v....vv.>...v.>.>.v>v..>>...v.>.>..v.v.v..>v.>.v>.v>.>.v..v.>.v......v..vv>..>..v>v....>.vvv.v..>....v...>v....>vv.v.v>v..v .v....v..v...........v>..v..>>>v.v...vvv...v..>.>.vv.>v...>.>.vvv.>...>>...vv.v>vv>>.......v>.v..>.v>vv.>v..>vv>.....>.v...v...v>>.>...>>>> ..v>>...>.>>vv..>vv...vv>.v>vv..v.v..>vvv.vvv>.v.v..v>v.v...v>.>..>.>.>vv.v..vv....v..>.>..v.>.>>>v>.>.>v>vv....vv..v>..v....v.v..v.vv>>... .>..>.>.v..v>.>v>>v..v>>>...vvvv.>.>>>v.vvv>.v..v.v.>..v..vv.v...v.>....v>v.>.>v.>...v.v...vv>>....vvvv...v>.v.>>..>vvv>v>>..vv.>.vv>v.v..v .vvvv.v.>.>.>v..v....vv.>...>.>v....vv..>...>.>..vv.>>.vv...v>.>.v.>..>.v>>>>..>..vv>>vv.>v>v.v.>>>v.v.vv.v..v..v..v..v.>v....>.v.vv.>..>vv v.>v....v>.vv>....v.>>.v.>.>vv>v>....>.vv>.....>..>.v>vv.>v>...vvvv>.>.vv.....v>v.v>.>.....v...v.vv>.>v..>v..v>>.v..v.v>>..>>.vv.vv.....>>> ...v>..>v.>v>>.>v...>.vv>....>v.vv>>.v>>......>.v>.v..>>>.>>>....>.>..>>.>.>.>>>v.>>.....>v..vv....v>>.vv>v..>>v..v>.>..>vvvv>....>..>..... vv>..v...>v..v..>.>..>>v>>>vvv..v>>v>v..v>vv....v>>.>v...>>>>v.>.vv>vvv>>.v.vv....v.v>.>v....v.....v.>.>....>.>v.vv..>vvv.v.>.>>v>v>.>>..v. .>.....vv>>>....>v...>.>.v>.>vvv.vvvv.>......>>.v>.v.>>v.v..v.....vvv..>.>v>vv.>>>...v.>.vv>v..v...v....>vv>v.vv>>vv.v...>>v>.>.>v..>..>v.. ....v..>........v>>.v..vv>.v>>.v...>...>.>>v.v.v.vvv...>>.v>>v>.>vvv..v..>v>v.v.vv..v>..vvvvv..vv>>.>>>...v.>.>.>>>>..v>..v.v.v>.v>.>...>>. v.v..v...v..vv>...v...v>..>v>.>v.vv...>.v>.v..>>..>..>>>..v..v...v>>.vv>>>v..vv.v.v...vvv..>..v.v..>....v..>>v..vv.v.v>.v>>.>.>.>>>..v.vv.. ...>v>>vvv..v.v...>v>..>>>>>...v>..vv.>..v..>>..v....>v.>v.>>.vvv>...>.v..v.>>...>.>..vv.>..v>..v..>.>v.>v..>v.v>vv>.v.>>>..v..........>.>. v.>v.vvvv.>..v.vv.v........>vvv..>.v>...>v.>>v>>.>.>.......>v>v.>>...v....v..>..>..v.vv..v>.>......>v.v...>.vv.>>v...>.v..v.v>v>>vv.vv.>.vv v.>..>>>.>.....>.>v..v.>.....>>v..v>>>v...vvv>..vv....v>.>.vv.>v....v>v...>..v..>..v>..>>.>>.v.v.>>.v>vvvv...>.>.....v>.>>.>v...v>..v>..>.. .....>.v..>>vvv>v..>>..>.v>>v.>>>>>.vv.>>>>..vv.>.>..>......>v.v.>>>v.....>>v>.>>v.v...v.>..v.>>.>>.vv..v....v.vv........>.>v..v...vv>>>.>> >v.v.>.....v.>.v...v..v.v>v...>...>..v.>>..v..v>v>>.v....v..>.>>>...vv>>....v.>......v>.v>>..vvv..vv..vv>.>vv.v>vv....>.v.....v.>>.vv.vv..> >..v.....vv>v..v.v.v.>>.v>.>>>.>..>vv...>vv.vv.v.vvv>..>.v>v.v>>.vvv>...>>...>..>.>.>v>v>v>.>>.v.v>v>..>.vv.vvvv..>..>...v.v>>>.v>...vv.v.v >>..>.>.vvv>.>>v>...>vv>>..>vv.>....>>.v..>vv...v>.>..>.v>...vv>..vv>v.>.v.vvv.>v....v..>v.v>v..v.v.v.>>vv>v.vv..>>.v.v.>>>..>..v..v>...... >v..>vv>vv.>.v..v>...>.>....>..>.v.v...v>..v>v.v...>.>>.>..v....>>..vv.v.>v.>.vv>>.>.>.>...>.v.........vv..vvv...>>.>..>...>.>>v>..v.v.v.v. .>>>.>v..>.....v...>..v..v>v>..v.....>.>v>>.v..>.>v....>.v..>>..v>....v>.vv..>>...........v..>.>...>v..vv.v>.v........v.>.v...>vv>.>>..v>>> v.>....>....vv.>v.v>v...v.>>..>v.>...v....v.>>>v...vvv.>...>...>>v>...>>vvv..v..v.>v.>>>..>.v>vv>.>..v>.v.>v..>v.v.>v.>>.>v..v.v.v>vvv>>.>. v.....>vv.vvv....>v....v>.v..>vvv>v>>....v...>.....vvvv>v.vv>.>v>vv.>.>.>.>v.>.v..>.>>v>>...vv.>.v.>.>..>..v>.>>>v>v.vvvv..>..v.>v>.>vv>..v vvv.>>>..v.v.v.v..........v.>..>.vv.v.....v>....v.v.vv>.>.v>vv...v..>v>.v>...>v..>..vvv.>>.>vv>v>..vv.>v....v..>.>>>.v>>.v.>vv....vvv>.>..> .vv.v...>..>.>.>v>v.vvv..v>>vvv.>.>.......>.>.>v.>..>>.>vv>v>.vv.v...>..v>.>>..v.v.v.>>.v>.v.v>>..>>.>...v>.v..>>.....vvv>.>v>v.>..>>.>v..v >vv..>..vv..v...>>.>.>>>.>.v..>...>..>>>v.v.>.v.....>.>...v>v>..>>.>v>.v.v>..v>..v.>>>.v>>>v>v..v>.vvvv>v..>>v.v>..v..>.v..v.>v..v.v..>.v.> >..v..v>v>v.vv.>.>>>.v>.....>.>>..>v>.v>.>..>v.>v.>>.>v...>.>>.>>.vv.v>..>v.......>>...>.vv....v...>>>>>.>.>.v...>>v>vv.v>.....v>v..v>...vv >>v>..v.>.v>v...v>.vvv>v>..>>..>.v>>.>v...v...>.>v>>.vvv.>v..>>...v.vv>.....>vv...>v.v.>v..>>v..vvv.v>>..>.v.v.v>vvv.....>>>v>..v>...v>v.v> v>.>>.>.v.v>..>v..v.>>>..>....v>..vvv>.....>>vv>v>....>.>...>>vv>>..>vvv>..v..>..v...v.>...vv.v.v.>..>>.v.>>v.......>>>..>..>........v....v ..v>.v..v>>>...v.>v....>>>.>...>.v.v.v>v..v...v>..>>>>>.>.v.v..>v...v.>.>>v>...vv....v>>>.>.vv.>.v....v..>>....>v.v.v..>.v...>.v>.>...>>.>v ....>v..v...v..v.....>....>vvv>>....v.vv.v.>.v...>>>..v...v.>>>.>vv..>..v>>v>v>..v>...>.>...v....v.v...>.>..>.v..>v>..>..>v....>vv.vv....>> ....v.>v>.v>...>>v>.>..>....v.v>v>.v..v>.v>vvv.v>.>v.vv>.......v>.>>>.v....vv.>....>>...v......>>.v>>vv>>>.>>>vv.v>.......v.>v.>.>....v.>.. ....vv.........v>.v.>..v.>.v..v>vv..vv..v.v..v..>..v..>>.v..>v...>..v>.>...>.v....v...>.>....v..>...v>>.>v.>.vvv>..>..v.>>v.>vv.v>...>..>.. .>.>v.>..v>....>v..>...v..>...vv..>.>v..>..v.>v..>v.>.>v>vv..v>vvv.v>>>..>.>>v....v.v..>>....v..v.vvv...>>>v...........>..>>.>>>..vvv...>.. .vv..vv...>>vv.>v.vv..>.v...vvv....v...v>.v.>..>>.>v..v..v....>vv.>.v.>...v...v>.>..v>>>vvv...v......v.v.>...v.v>..v>vvv.>......v..>....... >>>..>vv>>>v>.>>>....>>>..v>.v.>.v..v>v>>v.v....v.vv.>v>....>v>>..v.........>.v.>v.>...v>>>..>>v....v.v>v..>..>>v....v..v>..v.v..v.>.>..>v> >>.>>v>vv>v.vvv.>>>>v>...>..>>>>.v>v>..v.>>.>v..>.>v..v.>>.>>v.>..>vv.>...v.v>>v>.vv>..v...>>..v...v.v...>v..v.v.>>....v..>.>.v.>>.>.v..v.v v.vv.>v.v>...vv.v...>.v>>..v....>.v....>...vv.>v>>..>.v.v.v.>.>>>.>.v.v.>.v.>.....v>..>v.v....>>....v>.>.v.v..>..>v>...v...>.>>...>...vv.v> ...>v.......v.>.vv>>.>>...vv.....v...v.vv...>v.v>.>.>.>>...>v....v.>>....>v.>>.v.v>v.>...v.vv.v.>.>>>.vv.vv>v>...>...>.v.v>>v>.>vvvv>vv.>v. v..v.>v...v>>.>v....v.......vvv...v....>v..vv>v>v..>.vvvv..v.>>.vv.v.v.v>>v..>v.vv..>v.>.v>.>.>vv>.v>......>..vv.>>>.v.v.>..>v..v.>v>>>.v>> ..>>v.>...>v>.>>.>.v....>>v.v.>vv..>>....v>>.vvv.v>.....>v.....v>.>..>v.v.......v..v.>>>>.v>>v.>v>...v....v..v.v...>.>v...vvv..v.>..vv.v... >vv>.v.vv..v>v.v...v......>>.>v.v.v.v.......v...v.>.vvvv.......>....>.v>..v.....>.....>>>vv...>v>.v...vv.v>>>....>v>..>v..>v.v..>v.>.>.>>.. .>....v..>>..vv...>....vv.>>v>>>...>>v>..>.v...v>.v.vvv.v...v..v..v.vvv...>v.v....v.>vv.v>>...v>>v.>>v..v.v>.v>.......>..>v>v.vv>.....>>.vv v.vv>.>v...v>....v.>.v.>...>>v.>.>..>v.v.vvv....v>>vv.....>v..v>..vvvv.>.v..vv>>...>>>.>.>>...>...v...>v>vvv.v>>....v.v.v.v...v>v.....>v>.. .v...v>.>v..>v.v..v.v..>>.>..v..v>.v..>..v>.>v.>..>v.....v.>..>.v>vvvv.>..v..v>.v>.vv.v.v>.>.v.....v..v.>>>>.v.vv.vv....v>.>v...v..v>.vv>.> ..>v..>v>..vv>..vv>v>v..v.>>vv...v>v...>v>v.>.>vv..>.>....v.v.v>v..v>..>>vvv..>.>>v>...>....>v>vv......v..v>>..vvv..>..>v.vv>v.v.........>v ..v..v>>.v....>>.>vv>>v.>..>.>...vv..>v>.>....v.....v>>.>...>v>>>v>v.vv..v>vvv>.vv...v...>...>>.v...>v.....v>vv...v......>>>v.>>.>.>.v>.v.> v>>..v>...v>.>v...vv.>.v>..v.v>>.vv..v........v.>..v.>>>v>v...>.vvv.>>v.>.vv>>.>.v..>..v.v>.v..v...>..v>.v..>..v>.....>.vv>v..>>.>>.v....v. >vv.v>>v.vvv..vvvv>>v..v...>>.>>..>..vv>...>v....>v>v.....>.....>>....>...>..vv.v....>v>>>>v......>...vv>>.v..>.v.>.>.v..>.>......>v>vv.v.. ......>.>..>vv>.vv>>...vvvv....v.vv...v>>v>....>v.>...v.vv.>..v>.v>>vv.>....>v.>.v.vv.v>.vv>...v.>v>.>>..v>>v..>v.v...>....v.v....v>v.>.v.v >v>v.>vv....>.v>.v..>.>.>..>.vv....>.....>v>>..>>.>.>.>.>v.>...v>v..v>vvvv.>>v...>vv>>..v..v.>>.v.v>vv.>...........>.>.....>>.v..>.>...v..> v>v>>...>v..vv.........>v...v..v>.>..>>>>.v>..>v>>...>v..>>.....>.>.>>>>..vv.>vv....v>..>..>..vv>....vv.>>>...>.v..v>v......v>v>.v.v.v>.v.> >v..v>.v.....>>.v>>...v..vv>.>>>..v..v.>>..>..v....>v...>vvvv>.vv......v.>vv>>..v...v.>v>..vv.>.vv......>..>>>.....>......vv.>>>>>vv....>vv .>...v.v>.....v.>...>v>v..vv>>>>.>>>>v..vv.vvv.>>..>.>.v.>>.>v>>.>.>>v.v..v....v...v....v>>..v>..>.v.>v>vv>.>.>.>..>v>>.>..v...>.v>.....v.> vv..>..v...>>>..>v.>>..vv>vv.v.v>.v....>>v..>.>>v>>v.>v.v>.v>...>..v>...v>v>....>.>>..v>vv..>>.v.v.v>v>>.>..>v>..>.>>v>>....v>..>.....>>..v v.>>>.v..v>.>...v....v...>...>v.v...>..>..vv>.v..v>..v>.>v...v>>.>..v..v.v>.v.vv..>v..>..>.>..vv....v>v.>vv>.v.>.vv...>v.>v>vv.>v..v.v..v.. v.>v..>..v...v..v....v>.vv>v.>>.v.>v....>>.v.>v>>.......>>>..v..>...>v.v.>>>v........v....v.vv.vv>>..v>..v.v..v....v>.>v.>>...v>>..v...v... ..v>>..>>......v..>>.v.vvv>....>>vvvvv>vvvvv>v..>v>.v>vvvv..>....v>v>.v.>v>.>.>.>...>.>v.>.>..>.v>>v.vv>...v..>>v>>.>v>v>.v....vv..vv..>.>v ..v.>v.>v.v>>.>v.v>>.>.....v>v.v>vv>.vv>..>v.>...vv..>>vv.vv.>.v.>>>....>.>>>.>v>..>.v.v....>>>..v.>>.>..>>>.>>>>>....v.vvv.>.v.v.v>v>.>.>. >>vv..>...>.>.vv..>>.>.vv....>..>.>vv..v.>.v>..v..>....>v......>..>.>vv..>.v.>>>..v.>v>>v...vv..v>.v...>>..v>..>.v.v.>v..>>>...v..>>.v....v ..v.v..v>v.>.>..>v.v>>..>v.>.>>.>>>.v..v.>....v...v.>...>>v>.v....>.v.v>v>.>>>.>v.vv..vv...v>>.v...>vvv.>.vv.v....>>v.>>....v..>...v..v>..> .>v.vv..vv>>v>v>......>.....>>....vv>v...>......>..>....v>>v....v...vvvv.v....>v.>>..v.>>v....v.......vvv..v.>>>v....v.v...>.....v..v.....> >....vv.....>.v...v..v.v.>>>>.vvv>.vv>.>...v.v>..>>.vvv>v>.v..v.v..v>....vv.v>....>.....>>.vv.vv.v.v.>..>.v..v>>...>..>.>..v.>v...>.>...... .v.v>v>v>v>.>.>.vvv>.v..v>v>.v>....>vvvv.v>v...>>..v.>>.vv..v>>...v.v...>...>vv..>...>>>v.v...>>.......v.>..v>.v..........>>.>.v.>.>..v>.>v ..>>>>>.v.v......v...>..>>.>>..v...>...>>.....>vv...>>.>>.>v..v.vv..v..>>>..v>.....vvv..>>...>v.vv>>>...>vvv.>v>.v.>>..>>.>>v>>..>..v.v..v> v..>...v....>>v....v.v>..v...v.v.v....vv..>..v...>vv>>>v>>vv>>v..vvv..>>>v.v.v.>>...>v..vv>v.v..v.>v.....v.>...>.>.v>v>.>..v>>>.v.v>.v.>v.> >>.>vvv..>..v>v..>>..>.v.v..>.>v>.v...vv..vvv.v..vvv>..v.v.>....v..>.>..>...v.....v>.>...v.vvv...>...>>.>vvvv>>vvv.vvv....vvvv>>v....>>v.v. v>vv>.v....>.>.>>>..>..>.>v>..>...vv>>>.>..v>v.v.>.v....v.>...>..vv.>.>.v.v>.v..>>>..v>v>>.v..v.....>v..vv>>.>.>v>..vvvv>.>.v>.v..v..v>>>v. v.vv>>v>..v...>..>.vv>.v..vv......v.>>>v>v.>..vvv.>.v>>v..v.>...>.>....>...>v..vv.v..>.>vvv.v.v...>v.vvvvv...>>.vv.v>v.vvv..vvv.>.>..>>>.v> .>>>>v.>>>.>vv>v>.....>>>v>v.>v.vv...vvv>vv>.>.v.v>v...v>.>.v>v>.v>>vv>.v.>...>vv.vvv>v>.>v>v...>.>vv..vv>.vv...>..v....v.>v.>v>.....>..v.> v....>.>..>.>....>.>.vv....>v.v......vvv.v>vvv>..v.v>>.>vv>v>>..>>v>v>vvvvv.>>>>.v.>....v>v>..v.>.vv..>>.v>vv.....>>v..vv.v..v>.v..vv>..... .>v..v>>vvv.v.....>.v.>.>.v.>v>...v.v..>>....>vv....v.v>>>v.>...>....v.v>>...v>.>>...>....vv.vv.v>>.>.....>vv.v.v.>>.>>v...>>>.vvv...>v.... v>.>.v.....v..>.v.v..v...v.v>.vvv...vv.>.v.>.v>>>.v>.........>>>..>..v..v.vv>>.>...>>.v...v..>..>>vv>.>vv..>>vv>.v.>.>..>vvvvvv.>>....v.>v. ...>>.v>.>vv>..>v.>..v.....v>.>.>>....v>v...v.vvv.vv...>.>..>v..v>.>.>v...v..v.>v.v>vv..>.vv>...v>.>...vv>>....v>v...vv.>>..>>.>vv>.>..v.vv .v>v>.vvv.vv.>.v.v....v>v>....>>v..v......vvvv.>>....v>.....>vv.>..>v.v..vv.>>.vv>.v....v.........>>.vv..v.>.v....>.v.v..v>.v.>v.v....vv..v vv.v............>.vvv.>.....>>.v..v..v>>v.>>v..>...vv>v.>.>.>vvv>..>>v>v.v>.>.>v...>v>v>.>>v.....v.>.>..>>>v>>vvvv>..>...>vvvv....v..>>v.>. .v....>v.v.v.>.v>..>v.>.>.v.>>.>v..>.>>.>>v>>>vv>v>.>>.>.v.>..v>>vv>>v.>>>>>.>.>..>>...v>...>v..>.v>.v>vvv>.v....>v>>v...v>...>.>..>>.vvv.v v>.....v>.>.....v...vvv...v.v.>.>..>..vv.>>.v>>>v>...>.vv>v.....>.>.>.v..v.>....vv.>.>......vv>v.v.v.vv>vv..>v>>>..>.>>..>>vv>.>>>v..v.>..> vv..>.>.>..>.vvvv....v>...vv.v.v>vv......>>..v...v.....>>>>..v>v..v.v>..vv..v....vv..>>>..>>....>vvvv>.>.vvv>.>.>>>v.v>.vv>vv.....>.v....>. .>>>.......v>....>.v>.>v...>>>>v.v>>.vvv.v>.vvvv>>..>.v..v>.v.>>vv>.....>...>>v>.v.vvvv.>.........>...>>>v...>vv.v.v>>..>..v.>.....>v>v>.>. >.v...>......>..v.v.vv...v>.v.>v..>>>v>.v...>v.vvv>...vv>v.v.v.......>>...v...vvv>..vv>>v>...>.....v....v>.......v.vv...vvv>>>>vv>>.>...... .>>.v.>v.v.>...>.v..>>..v....>>vv>v...>..v>>vv..v..>>>v..vv>.vv...>.>....>>>.v..>.>.>.v>v....vv.>>>.>>v>>.>vv.>v>vv...vvvvv.>>.....>v...v.. v.v.v.vvv..>...>>v.>>..>v>>....>.>>......v.>v...>.v>.....vv.v.vv>>.v.>>...>.v.v.v..>>.vvv>v..v.v....>.v.v>v>>.v>>v.>.v.v>>>>.>..>>.>.v>.>>> ..>.v>..v..vv>v..>vv.>>.v.v>..v.>v..v.>.v>..>vv...v....>>v.v..>.....v>v...>.v...>v..vv.v...>.>.>v..vvv.>..vv....vvvvvv.>.vvv.>.>..>......vv .v>.>.vv..v...vvv.>.>.>>>.v>....>...v>.....v.>.>>v.>..v.>.vvv.......v.v.v.>..>.vv>....v.>.v......vvv.v..>....>v.....vv>...>v.v.vv..v>>v..v. .v.v.v..>>>.....vvv..>.>.....v>v>..>>>......v.>>v.>.vv>..>..v>v.....>>.vvv.>v>.>>.>>v>vv.vvv...v.>.....vv...>v.v.vvv..>.v>.>>..v>v>vvv...vv .vv>>..vv.v..v...vv.>>....vvv.v>...vv.vvv..>...v.v.v>>.>.>.v..>>...>v....v>>.v.>vvv.>.v.>>.v.>v>>.v..v..v....v.>.v..vv.v>>.....vvv.v>.vv.>. vv.v.>v...v>...........>.v>.>vvvv.>..>>>.....>>.v.v..>v>...v.>>.>>>.v.vv.v>vv>v>.>>v>v....v..v>..v>vv..>v...v..>..>>>>>.>.....vv>.>>>>...v. .v.v..v>.vv..>>...v..>..>..v>>.>>vv>v....>vvv.>>.vv.vv>vv>v.vv>.>v..>.>.......>v....v>...>..v....v.vv>>....v>.v.v.v>..>v>.>.......v>.>>>>>. vv....v.>.v>v>...v>.v.v>..v.v..>..>...>>.>.>...>....>....vv>v>>...>v.v...vv>v.v.v......>.v.vv..v>..>v...v.vv.>>>>...v.v.>.>.....>....>v>... ...>vv..>>vv.v>>....vv..vv..v>>...>.v>>>.v......v.v.>.v.vv....vv.v....vvv>>.v..>>vvvv...>.v.>>.>.>.vvv.v>.....v..>.vv.>..>..v>v>v..>..>>v.v .vvv.>.vvv>.>v..v>..>v.v.>.>...>>.>>>.>.vv>>.>.>>>vv>..>>.>>.>.....>..vvv.>.>v.>..v..>v..v>v.v.>>.>v.v..vv>v..>.vv>v...v>>..vv>v.>v..v>v>>> v>......v>v>>....vv...v>>v>..>>>>....v..>>...v..>v..>>.v>v.v....>>>.v..vv......v..v>..>.v.v>>>v.v>....v.v>.>..v>>>..>.v>>.v.v.>v>.v..v.v... vvvv>>.>..>v.vvv..v.v>>..>..>v>>>..>....>.v>..vv...v.>.>v.vv.>>v>v>v.vvv..>.>v..>>>>.>....v>..v.>>..vvvvv.v>.>.>>.>v...v..>v>>vvv.v...>>>.. v.>..>.v>..v.>>.vv.v..>v.vv..>v.>...vvvv.v.vv..>.vv>..>v>..v>.....>....v>...v.v..>.v...>>v..>v.....v.>>vv>....>..v...>>>.>v.>.>vvv..>>.v.vv ..>.v.........>..>.......>.v.>>>>v.v.vvvv>..>v..v.>v>>v..v..>..v.v>>...vvvv.v...>.>...>>>>>>...v>.>vv>.>v>v>.v.v..v>.>.>v.v>.v>.......>.>.. ..v.>>..>v..vv..v>>v....>>>....>.>>.>.>>v>>...>>>vvv>>v>..>..v....v..v..>v>...v.>>>vv.v.v>.>.v.v>>>..>.>.>v>v>v.>.vvv.v.>>>>>...>>v..vvv>>v v.>.>>.vv.>.>...>v.>>v>...v..>v....v.>.>..vv..>..v>..v.v...v.v>.>>v>.vv.>..vv>...>v.>.v..v.>.v.vv>v>...v....>.>v..>.v..v>>v>.>...>...v.>.v. .>.>....>>.v>.v..v....v>.>>>>.v...v..v...v.>..v......>>.>..vv>..v...v.v...>vv.>>..>....>>>.>v>vv>..>vv>.v>>.>..>.>vv.v...>.>...>v.>vv>vv.>> .>...>.>v>..>vv....>.vv.>..v.v.vv>v..>vv..v>..>....vv>vv.v>>.v>>.vv>.>>v..>...v>....v>vv..>..v.v.v..v>.v..vv.v.v.>.>....v>v..>...>.>vv..vv> >.v>...>>.>.v..>>v>.>...>.vv>.vv.>..vvv>.>vvv..>..>v.....v.>>vv...>v...v...v..v.v..v>>v>>>>.>v..vv......>..>.v.....v.>>>.>.>.vv>.>.>v.v.v>. v...>.v.>v>.v.>....>....v.v>..>>v..>..>>>>..>..vv...>.v.>>>>>.>>v>>....v...>.....v..v>.....>..>....v...v.v..v>v.>....vv..v......v>>v...>..v ....v.v.>.v.v>.>>..>>.v..v>v......>...v..v.>>....>......v>..>v>>.>vv>..>v>vv>v..vv.v.>>.vvv..vvv>..vvv..>v>vv.>>.>v.v.>.>..v.>v...........> vv......v.>.>v.>vv>>...>v.>..>v>v>>v.vvv>...>>..>.>..>>v.vv.>>>>>.v...vv..v.vvvv.>..>>v>.>>vvvvvv.v.v>.v.vv...>v>..>..v>v>v...>>.v>.v.v>..v ....v..>.>v.>v.......v>v....v....>v>.>.>v.v.v>..>.>..v.v>>.vvv........>..>.v..>.>>v.>...>>.>>......>>.>...>.>..v..>....>>.vv>.v.........v.v ....>>.v..>v>...>..>.>...v>....>>.vvv..>..v>.......>...v>v>>.v>.>...>.v.v.>...>>......v...>..v....v>>v......vvvv...vv.>>>vvv..>v>v.v.v.vv.. ...v....>v..>.v.vv.>.v.>..>.>...v..>vv>..>>v>>.>.>..v.v.v..>vv.>vv.v..v...v>v>>.v..>.v>..>v.>.>..>vv.>v...>>.>...v.>.v.>>..>.>v.v>.>.vvvv.v .v>v.>>....>>.>.>.v>..>...>.v...v..>.v..v....v.vv>>>>.vv.v..>....>..>v.>..v>>>....vv>.v.>...>..vv>.v.vv.>>.>...v>>v>.v.vv.....>.vv>.>..>... ..>vv.>..>.v..>..>...vvvvv..v.v>..>vvv..v.v>..v..v.>..>..>..>.>.>..v......v>>>>v.>>.v>...v..>>vvv..>>>>..>>.vv..>.>>..>vv>>..>.>vv.>.v.v.>v',' ') AS lines
WITH lines, range(0,size(lines)-1) AS linerange, range(0,size(lines[0])-1) AS columnrange
UNWIND linerange AS line
UNWIND columnrange AS column
MERGE (s:Posi {
	pos:(column+((line+1)%size(lines))*size(lines[0]))})
MERGE (p:Posi {
	pos:(column+line*size(lines[0]))})
MERGE (e:Posi {
	pos:((column+1)%size(lines[0])+line*size(lines[0]))})
MERGE (s)<-[:MOVESOUTH]-(p)-[:MOVEEAST]->(e)
WITH split(lines[line],'') AS cucumbers,line,lines
UNWIND range(0,size(cucumbers)-1) AS c
MATCH (p:Posi{
	pos:c+line*size(lines[0])})
SET p.floor = cucumbers[c]
RETURN max(size(lines)) as rows, max(size(lines[0])) as columns



CALL apoc.periodic.commit(
 '
MATCH (p{
	floor:">"})-[:MOVEEAST]->(e{
	floor:"."}) SET p.floor=".", e.floor=">"
RETURN COUNT(p) AS c
LIMIT 1
UNION
MATCH (p{
	floor:"v"})-[:MOVESOUTH]->(s{
	floor:"."}) SET p.floor=".", s.floor="v"
RETURN count(p) AS c
LIMIT 1') yield executions
RETURN executions AS steps