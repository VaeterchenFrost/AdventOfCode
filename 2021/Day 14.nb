(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     44192,       1171]
NotebookOptionsPosition[     39879,       1078]
NotebookOutlinePosition[     40293,       1094]
CellTagsIndexPosition[     40250,       1091]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Advent of Code 2021 - Day 14: Extended Polymerization", "Title",
 CellChangeTimes->{{3.8485029038536434`*^9, 
  3.8485029462504787`*^9}},ExpressionUUID->"7378e219-4fb8-4010-9c26-\
f35172a8bb37"],

Cell[CellGroupData[{

Cell["Parsing", "Section",
 CellChangeTimes->{{3.8485037902276707`*^9, 
  3.8485037918605986`*^9}},ExpressionUUID->"59b85b90-8a42-43af-8d47-\
2f3d0733b3f7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "input", "=", 
   "\"\<NNCB\n\nCH\[Rule]B\nHH\[Rule]N\nCB\[Rule]H\nNH\[Rule]C\nHB\[Rule]C\n\
HC\[Rule]B\nHN\[Rule]C\nNN\[Rule]C\nBH\[Rule]H\nNC\[Rule]B\nNB\[Rule]B\nBN\
\[Rule]B\nBB\[Rule]N\nBC\[Rule]B\nCC\[Rule]N\nCN\[Rule]C\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.848499629006196*^9, 3.8484996406954217`*^9}, 
   3.8484996929725027`*^9},
 CellLabel->"In[61]:=",ExpressionUUID->"b035c77b-6442-4827-b9af-93517f39f522"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lines", "=", 
  RowBox[{"StringSplit", "[", 
   RowBox[{"input", ",", "\"\<\\n\>\""}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.848499658596217*^9, 3.8484997240374126`*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"65c645d3-3bf4-48cd-a1de-13e1d5da5aed"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"NNCB\"\>", ",", "\<\"\"\>", ",", "\<\"CH\[Rule]B\"\>", 
   ",", "\<\"HH\[Rule]N\"\>", ",", "\<\"CB\[Rule]H\"\>", 
   ",", "\<\"NH\[Rule]C\"\>", ",", "\<\"HB\[Rule]C\"\>", 
   ",", "\<\"HC\[Rule]B\"\>", ",", "\<\"HN\[Rule]C\"\>", 
   ",", "\<\"NN\[Rule]C\"\>", ",", "\<\"BH\[Rule]H\"\>", 
   ",", "\<\"NC\[Rule]B\"\>", ",", "\<\"NB\[Rule]B\"\>", 
   ",", "\<\"BN\[Rule]B\"\>", ",", "\<\"BB\[Rule]N\"\>", 
   ",", "\<\"BC\[Rule]B\"\>", ",", "\<\"CC\[Rule]N\"\>", 
   ",", "\<\"CN\[Rule]C\"\>"}], "}"}]], "Output",
 CellChangeTimes->{{3.848499697444907*^9, 3.8484997261820407`*^9}},
 CellLabel->"Out[63]=",ExpressionUUID->"f631c3c3-bc8a-41c5-b5ff-3b3678d0d168"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"polymertemplate", "=", 
  RowBox[{"Characters", "@", 
   RowBox[{"lines", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8485030334869385`*^9, 3.8485030601287827`*^9}, {
  3.848503905645571*^9, 3.8485039069809914`*^9}},
 CellLabel->
  "In[199]:=",ExpressionUUID->"a4b1abfb-99b6-4732-95da-1bb6800a5599"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"N\"\>", ",", "\<\"N\"\>", ",", "\<\"C\"\>", ",", "\<\"B\"\>"}],
   "}"}]], "Output",
 CellChangeTimes->{3.848503078024017*^9, 3.848503907734556*^9},
 CellLabel->
  "Out[199]=",ExpressionUUID->"339b8331-630d-4c48-8831-d6a75a9ae4b9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"stringrules", "=", 
  RowBox[{"lines", "[", 
   RowBox[{"[", 
    RowBox[{"3", ";;"}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.848499768843776*^9, 3.848499778217414*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"3b54a300-6319-4f51-aec9-e2a0a0370e0c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"CH\[Rule]B\"\>", ",", "\<\"HH\[Rule]N\"\>", 
   ",", "\<\"CB\[Rule]H\"\>", ",", "\<\"NH\[Rule]C\"\>", 
   ",", "\<\"HB\[Rule]C\"\>", ",", "\<\"HC\[Rule]B\"\>", 
   ",", "\<\"HN\[Rule]C\"\>", ",", "\<\"NN\[Rule]C\"\>", 
   ",", "\<\"BH\[Rule]H\"\>", ",", "\<\"NC\[Rule]B\"\>", 
   ",", "\<\"NB\[Rule]B\"\>", ",", "\<\"BN\[Rule]B\"\>", 
   ",", "\<\"BB\[Rule]N\"\>", ",", "\<\"BC\[Rule]B\"\>", 
   ",", "\<\"CC\[Rule]N\"\>", ",", "\<\"CN\[Rule]C\"\>"}], "}"}]], "Output",
 CellChangeTimes->{3.848499778887583*^9},
 CellLabel->"Out[65]=",ExpressionUUID->"aa73e7ac-cb69-47cc-861b-c0222dbf41fb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rules", "=", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Characters", "@", 
         RowBox[{"StringTake", "[", 
          RowBox[{"#", ",", "2"}], "]"}]}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", "1", "}"}]}], "]"}], ",", 
            RowBox[{"StringTake", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", "4", "}"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", "4", "}"}]}], "]"}], ",", 
            RowBox[{"StringTake", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", "2", "}"}]}], "]"}]}], "}"}]}], "}"}]}], ")"}], 
      "&"}], ",", "stringrules"}], "]"}], "//", "Sort"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8484997983650827`*^9, 3.848499905090432*^9}, {
  3.848499987152194*^9, 3.8485000193227406`*^9}, {3.8485000515167*^9, 
  3.8485001225395937`*^9}, {3.848500163572602*^9, 3.848500222792314*^9}, {
  3.848500308727456*^9, 3.8485003117352233`*^9}, {3.848500602036378*^9, 
  3.8485006243814216`*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"29108642-6338-4e49-b705-5f02f71b74c4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"B\"\>", ",", "\<\"B\"\>"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\<\"B\"\>", ",", "\<\"N\"\>"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\<\"N\"\>", ",", "\<\"B\"\>"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"B\"\>", ",", "\<\"C\"\>"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\<\"B\"\>", ",", "\<\"B\"\>"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\<\"B\"\>", ",", "\<\"C\"\>"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"B\"\>", ",", "\<\"H\"\>"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\<\"B\"\>", ",", "\<\"H\"\>"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"B\"\>", ",", "\<\"N\"\>"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\<\"B\"\>", ",", "\<\"B\"\>"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\<\"B\"\>", ",", "\<\"N\"\>"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"C\"\>", ",", "\<\"B\"\>"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\<\"C\"\>", ",", "\<\"H\"\>"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\<\"H\"\>", ",", "\<\"B\"\>"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"C\"\>", ",", "\<\"C\"\>"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\<\"C\"\>", ",", "\<\"N\"\>"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\<\"N\"\>", ",", "\<\"C\"\>"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"C\"\>", ",", "\<\"H\"\>"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\<\"C\"\>", ",", "\<\"B\"\>"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\<\"B\"\>", ",", "\<\"H\"\>"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"C\"\>", ",", "\<\"N\"\>"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\<\"C\"\>", ",", "\<\"C\"\>"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\<\"C\"\>", ",", "\<\"N\"\>"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"H\"\>", ",", "\<\"B\"\>"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\<\"H\"\>", ",", "\<\"C\"\>"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\<\"C\"\>", ",", "\<\"B\"\>"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"H\"\>", ",", "\<\"C\"\>"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\<\"H\"\>", ",", "\<\"B\"\>"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\<\"B\"\>", ",", "\<\"C\"\>"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\<\"H\"\>", ",", "\<\"N\"\>"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\<\"N\"\>", ",", "\<\"H\"\>"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"H\"\>", ",", "\<\"N\"\>"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\<\"H\"\>", ",", "\<\"C\"\>"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\<\"C\"\>", ",", "\<\"N\"\>"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"N\"\>", ",", "\<\"B\"\>"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\<\"N\"\>", ",", "\<\"B\"\>"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\<\"B\"\>", ",", "\<\"B\"\>"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"N\"\>", ",", "\<\"C\"\>"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\<\"N\"\>", ",", "\<\"B\"\>"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\<\"B\"\>", ",", "\<\"C\"\>"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"N\"\>", ",", "\<\"H\"\>"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\<\"N\"\>", ",", "\<\"C\"\>"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\<\"C\"\>", ",", "\<\"H\"\>"}], "}"}]}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"N\"\>", ",", "\<\"N\"\>"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\<\"N\"\>", ",", "\<\"C\"\>"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\<\"C\"\>", ",", "\<\"N\"\>"}], "}"}]}], "}"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.8485001253272576`*^9, {3.848500164552991*^9, 3.84850022550415*^9}, 
   3.848500312344982*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"0c8467d7-b2ce-4c99-8caf-81927cef1a47"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Create Matrix of Pair Insertion", "Section",
 CellChangeTimes->{{3.8485038004763875`*^9, 
  3.848503836311088*^9}},ExpressionUUID->"d6391d24-e378-4245-aff4-\
5441ee6bea09"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"intmapping", "=", 
  RowBox[{"MapIndexed", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Rule]", 
      RowBox[{"First", "@", "#2"}]}], "&"}], ",", 
    RowBox[{"rules", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8485003455483527`*^9, 3.8485003751791*^9}, {
  3.848500483890524*^9, 3.8485005151008167`*^9}, {3.848500548456949*^9, 
  3.8485005703924513`*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"9c1e49c3-c706-41a5-ac5b-5d7550ae7661"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"B\"\>", ",", "\<\"B\"\>"}], "}"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"B\"\>", ",", "\<\"C\"\>"}], "}"}], "\[Rule]", "2"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"B\"\>", ",", "\<\"H\"\>"}], "}"}], "\[Rule]", "3"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"B\"\>", ",", "\<\"N\"\>"}], "}"}], "\[Rule]", "4"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"C\"\>", ",", "\<\"B\"\>"}], "}"}], "\[Rule]", "5"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"C\"\>", ",", "\<\"C\"\>"}], "}"}], "\[Rule]", "6"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"C\"\>", ",", "\<\"H\"\>"}], "}"}], "\[Rule]", "7"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"C\"\>", ",", "\<\"N\"\>"}], "}"}], "\[Rule]", "8"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"H\"\>", ",", "\<\"B\"\>"}], "}"}], "\[Rule]", "9"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"H\"\>", ",", "\<\"C\"\>"}], "}"}], "\[Rule]", "10"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}], "}"}], "\[Rule]", "11"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"H\"\>", ",", "\<\"N\"\>"}], "}"}], "\[Rule]", "12"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"N\"\>", ",", "\<\"B\"\>"}], "}"}], "\[Rule]", "13"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"N\"\>", ",", "\<\"C\"\>"}], "}"}], "\[Rule]", "14"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"N\"\>", ",", "\<\"H\"\>"}], "}"}], "\[Rule]", "15"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\<\"N\"\>", ",", "\<\"N\"\>"}], "}"}], "\[Rule]", "16"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.8485003559679995`*^9, {3.8485005079667606`*^9, 3.8485005159845285`*^9}, {
   3.8485005516559334`*^9, 3.848500571229354*^9}},
 CellLabel->"Out[87]=",ExpressionUUID->"600e137c-aca6-47ed-9820-f5e484d6c6dd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\"\<B\>\"", ",", "\"\<B\>\""}], "}"}], "\[Rule]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<B\>\"", ",", "\"\<N\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<N\>\"", ",", "\"\<B\>\""}], "}"}]}], "}"}]}], "/.", 
  "intmapping"}]], "Input",
 CellChangeTimes->{{3.848500706450198*^9, 3.8485007560389485`*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"8a858cce-9594-4fe8-a803-eb70f76799ad"],

Cell[BoxData[
 RowBox[{"1", "\[Rule]", 
  RowBox[{"{", 
   RowBox[{"4", ",", "13"}], "}"}]}]], "Output",
 CellChangeTimes->{{3.848500730714297*^9, 3.848500757117691*^9}},
 CellLabel->"Out[92]=",ExpressionUUID->"1b3f6cf5-ec41-4c91-a503-eb1b326a2925"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"transformations", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "}"}], "&"}], ",", 
      "rules"}], "]"}], "/.", "intmapping"}], "//", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8485005836213446`*^9, 3.848500585794385*^9}, {
  3.848500661206967*^9, 3.8485006975302563`*^9}, {3.848501229630964*^9, 
  3.8485012743546925`*^9}, {3.8485013131253033`*^9, 3.8485013359595532`*^9}, {
  3.8485013677371435`*^9, 3.8485014169724016`*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"f68f00d6-87bb-4e7e-96b5-05a75fa991bb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"13", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"14", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12", ",", "11"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"15", ",", "11"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"13", ",", "13"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "13"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"13", ",", "14"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "14"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"14", ",", "15"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "15"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"14", ",", "16"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "16"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.84850131939046*^9, 3.848501336662386*^9}, {
  3.8485013844874983`*^9, 3.848501417413602*^9}},
 CellLabel->
  "Out[110]=",ExpressionUUID->"92438e3b-4de7-48ca-9038-2a6703bb90ba"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"matrix", "=", 
  RowBox[{"SparseArray", "[", 
   RowBox[{
    RowBox[{"transformations", "\[Rule]", 
     RowBox[{"Table", "[", 
      RowBox[{"1", ",", 
       RowBox[{"Length", "@", "transformations"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Length", "@", "rules"}], ",", 
      RowBox[{"Length", "@", "rules"}]}], "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8485014238492928`*^9, 3.848501532276742*^9}, {
  3.848501658118132*^9, 3.8485016751510515`*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"399ff505-2b0c-4ff9-a2e7-fc1d60f19333"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["SparseArray",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJxTTMoPSmVmYGAQgGIQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtmPio+K
00J8Z7eB684tL+xvuC9fVzPtrf3JiNx/8V/fDzp3joYDdf1Fqvhg89dQCc/B
5v7BJj7Uw22ou39UfHCmh+GargbKX8M1PAcqfGgdnkPd/MFm71BJV0NFfLj6
a7CJD7ZyabD5d7iGw1ARH6711GATH+rhMNTTyUgrhwfKXwBPztqk
              "], {{0, 0}, {16, 16}}, {0, 1}], AspectRatio -> 1, Axes -> 
             False, Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
             Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], 
             Method -> {
              "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
               Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["32", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"16", ",", "16"}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJxTTMoPSmVmYGAQgGIQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtmPio+K
00J8Z7eB684tL+xvuC9fVzPtrf3JiNx/8V/fDzp3joYDdf1Fqvhg89dQCc/B
5v7BJj7Uw22ou39UfHCmh+GargbKX8M1PAcqfGgdnkPd/MFm71BJV0NFfLj6
a7CJD7ZyabD5d7iGw1ARH6711GATH+rhMNTTyUgrhwfKXwBPztqk
              "], {{0, 0}, {16, 16}}, {0, 1}], AspectRatio -> 1, Axes -> 
             False, Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
             Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], 
             Method -> {
              "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
               Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["32", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"16", ",", "16"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0.125`", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"\"", "SummaryItem"]}]}, {
               TagBox[
                TagBox[
                 GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "4"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "13"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                 "Column"], "SummaryItem"]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  SparseArray[
  Automatic, {16, 16}, 0, {
   1, {{0, 3, 6, 8, 10, 12, 13, 15, 19, 21, 23, 24, 25, 28, 31, 32, 32}, {{
     2}, {4}, {13}, {2}, {10}, {14}, {3}, {7}, {1}, {4}, {7}, {9}, {8}, {5}, {
     15}, {6}, {8}, {12}, {16}, {5}, {10}, {9}, {12}, {3}, {11}, {1}, {13}, {
     14}, {6}, {15}, {16}, {11}}}, {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1}}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{{3.848501489307285*^9, 3.848501533625803*^9}, {
  3.8485016778964005`*^9, 3.848501705647154*^9}},
 CellLabel->
  "Out[120]=",ExpressionUUID->"f749839f-b2b2-451f-8eca-1f281da769e7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "matrix", "]"}]], "Input",
 CellChangeTimes->{3.8485023762408953`*^9},
 NumberMarks->False,
 CellLabel->
  "In[153]:=",ExpressionUUID->"af2c85bf-ac7c-4db3-ba32-b506fd9324b0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "1", 
      "0", "0"},
     {"0", "0", "1", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"1", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "1", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "1", "0", "0", "0", "1", "0", "0", 
      "0", "1"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "1", "0", "0", 
      "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", 
      "0", "0"},
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "1", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "1", "1"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {16, 16}, 0, {
     1, {{0, 3, 6, 8, 10, 12, 13, 15, 19, 21, 23, 24, 25, 28, 31, 32, 32}, {{
       2}, {4}, {13}, {2}, {10}, {14}, {3}, {7}, {1}, {4}, {7}, {9}, {8}, {
       5}, {15}, {6}, {8}, {12}, {16}, {5}, {10}, {9}, {12}, {3}, {11}, {1}, {
       13}, {14}, {6}, {15}, {16}, {11}}}, {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
      1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
      1}}]]]]], "Output",
 CellChangeTimes->{3.8485015232254443`*^9, 3.8485023769320517`*^9},
 CellLabel->
  "Out[153]//MatrixForm=",ExpressionUUID->"f4de1a17-ff30-49db-bb5c-\
02dbcaa4c32b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initial Polymer", "Section",
 CellChangeTimes->{{3.848503878865398*^9, 3.8485038808504763`*^9}, {
  3.8485039578234773`*^9, 
  3.8485039587751093`*^9}},ExpressionUUID->"4bbcc620-6a36-47bc-a963-\
8962f237f50a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Rule", "@@", "#"}], "&"}], "/@", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Tally", "@", 
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{"Characters", "[", 
        RowBox[{"lines", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "2", ",", "1"}], "]"}]}],
     "/.", "intmapping"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.848501897017682*^9, 3.848501921760623*^9}, {
   3.8485019683636074`*^9, 3.848502047121091*^9}, 3.848502078828931*^9},
 CellLabel->
  "In[138]:=",ExpressionUUID->"57a96cd7-5ec8-4277-ba23-8e7e0ee91157"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"16", "\[Rule]", "1"}], ",", 
   RowBox[{"14", "\[Rule]", "1"}], ",", 
   RowBox[{"5", "\[Rule]", "1"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.848501901278373*^9, {3.8485019703163023`*^9, 3.8485020171737127`*^9}, 
   3.848502047646901*^9, 3.848502080784965*^9},
 CellLabel->
  "Out[138]=",ExpressionUUID->"9849764a-499b-450f-9d65-85d8952e2ea6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"init", "=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "@", "rules"}]}], "]"}], "//", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Rule", "@@", "#"}], "&"}], "/@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Tally", "@", 
        RowBox[{"Partition", "[", 
         RowBox[{"polymertemplate", ",", "2", ",", "1"}], "]"}]}], "/.", 
       "intmapping"}], ")"}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.848498336275673*^9, 3.84849833794781*^9}, {
   3.848502087924755*^9, 3.84850209701231*^9}, 
   3.848503933878969*^9},ExpressionUUID->"0631d165-2b4d-4a07-8767-\
3ab5ba7edef3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", 
   "1"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8484983386270237`*^9, {3.848502091595954*^9, 3.848502097673986*^9}},
 CellLabel->
  "Out[140]=",ExpressionUUID->"07de698c-3584-4867-a9f6-e0ee9746fe26"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Multiplication ", "Section",
 CellChangeTimes->{{3.8485039781215277`*^9, 
  3.8485039874899273`*^9}},ExpressionUUID->"ecb6acf0-a44a-418b-8fb7-\
390aecb47385"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"resultingpairs", " ", "=", " ", 
  RowBox[{
   RowBox[{"MatrixPower", "[", 
    RowBox[{"matrix", ",", "10", ",", "init"}], "]"}], "*", 
   RowBox[{"rules", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"doubletotal", "=", 
  RowBox[{
   RowBox[{"Total", "@", 
    RowBox[{"Flatten", "@", "resultingpairs"}]}], "+", 
   RowBox[{"First", "@", "polymertemplate"}], "+", 
   RowBox[{"Last", "@", "polymertemplate"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8485021931715865`*^9, 3.8485021949717507`*^9}, 
   3.8485023040437627`*^9, {3.8485025515497327`*^9, 3.8485026059530053`*^9}, {
   3.8485026400987387`*^9, 3.848502672061941*^9}, {3.8485027743814325`*^9, 
   3.8485027911653*^9}, {3.8485031698412333`*^9, 3.848503170640486*^9}, {
   3.8485032361016135`*^9, 3.8485032549263554`*^9}, {3.848503939304662*^9, 
   3.8485039418066173`*^9}, {3.8485040116206455`*^9, 3.848504034973999*^9}},
 NumberMarks->False,
 Background->RGBColor[1, 0.85, 0.85],
 CellLabel->
  "In[200]:=",ExpressionUUID->"c7f14875-9da7-4594-a1da-0bfb17ddf7b9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"812", " ", "\<\"B\"\>"}], ",", 
     RowBox[{"812", " ", "\<\"B\"\>"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"120", " ", "\<\"B\"\>"}], ",", 
     RowBox[{"120", " ", "\<\"C\"\>"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"81", " ", "\<\"B\"\>"}], ",", 
     RowBox[{"81", " ", "\<\"H\"\>"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"735", " ", "\<\"B\"\>"}], ",", 
     RowBox[{"735", " ", "\<\"N\"\>"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"115", " ", "\<\"C\"\>"}], ",", 
     RowBox[{"115", " ", "\<\"B\"\>"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"60", " ", "\<\"C\"\>"}], ",", 
     RowBox[{"60", " ", "\<\"C\"\>"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"21", " ", "\<\"C\"\>"}], ",", 
     RowBox[{"21", " ", "\<\"H\"\>"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"102", " ", "\<\"C\"\>"}], ",", 
     RowBox[{"102", " ", "\<\"N\"\>"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"26", " ", "\<\"H\"\>"}], ",", 
     RowBox[{"26", " ", "\<\"B\"\>"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"76", " ", "\<\"H\"\>"}], ",", 
     RowBox[{"76", " ", "\<\"C\"\>"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"32", " ", "\<\"H\"\>"}], ",", 
     RowBox[{"32", " ", "\<\"H\"\>"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"27", " ", "\<\"H\"\>"}], ",", 
     RowBox[{"27", " ", "\<\"N\"\>"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"796", " ", "\<\"N\"\>"}], ",", 
     RowBox[{"796", " ", "\<\"B\"\>"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"42", " ", "\<\"N\"\>"}], ",", 
     RowBox[{"42", " ", "\<\"C\"\>"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"27", " ", "\<\"N\"\>"}], ",", 
     RowBox[{"27", " ", "\<\"H\"\>"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8485021890331583`*^9, 3.8485021962922688`*^9}, 
   3.8485023049062214`*^9, {3.848502525046957*^9, 3.848502537968355*^9}, 
   3.848502579611348*^9, {3.8485026500868607`*^9, 3.8485026860251436`*^9}, {
   3.848502782484681*^9, 3.848502791543762*^9}, 3.848503171493147*^9, {
   3.8485032407815695`*^9, 3.848503255420494*^9}, 3.8485040376319113`*^9},
 CellLabel->
  "Out[200]=",ExpressionUUID->"370baba4-866f-4fa5-b3ab-f10aeba6fa5c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"3498", " ", "\<\"B\"\>"}], "+", 
  RowBox[{"596", " ", "\<\"C\"\>"}], "+", 
  RowBox[{"322", " ", "\<\"H\"\>"}], "+", 
  RowBox[{"1730", " ", "\<\"N\"\>"}]}]], "Output",
 CellChangeTimes->{{3.8485021890331583`*^9, 3.8485021962922688`*^9}, 
   3.8485023049062214`*^9, {3.848502525046957*^9, 3.848502537968355*^9}, 
   3.848502579611348*^9, {3.8485026500868607`*^9, 3.8485026860251436`*^9}, {
   3.848502782484681*^9, 3.848502791543762*^9}, 3.848503171493147*^9, {
   3.8485032407815695`*^9, 3.848503255420494*^9}, 3.848504037640934*^9},
 CellLabel->
  "Out[201]=",ExpressionUUID->"ffef41bc-d3c8-46fa-b83c-34e23a46c2ab"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/", "2"}], "&"}], "/@", 
     RowBox[{"List", "@@", "doubletotal"}]}], "//", "MinMax"}], "//", 
   "Differences"}], "//", "First"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.848503196247007*^9, 3.848503219516598*^9}, {
  3.848503325891403*^9, 3.848503336067502*^9}, {3.848503466229069*^9, 
  3.8485035655572186`*^9}, {3.8485036285536146`*^9, 3.848503653602018*^9}, {
  3.8485036877342715`*^9, 3.8485037431852236`*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[202]:=",ExpressionUUID->"e8592bea-1c33-4558-8613-b25fb7e77dc7"],

Cell[BoxData["1588"], "Output",
 CellChangeTimes->{{3.848503211154808*^9, 3.8485032201101036`*^9}, 
   3.848503329533182*^9, {3.848503495281335*^9, 3.8485034998606033`*^9}, {
   3.8485035428174324`*^9, 3.848503565938122*^9}, {3.8485036290964403`*^9, 
   3.8485036542058673`*^9}, {3.8485037206924243`*^9, 3.848503743659276*^9}, 
   3.848504049926672*^9},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "Out[202]=",ExpressionUUID->"89237054-8789-4a46-8445-1962b679b79c"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440., 748.5},
WindowMargins->{{-4.875, Automatic}, {Automatic, -4.875}},
FrontEndVersion->"12.2 for Microsoft Windows (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"d324dcb3-d654-4de8-91c3-62e9e399bc23"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 200, 3, 98, "Title",ExpressionUUID->"7378e219-4fb8-4010-9c26-f35172a8bb37"],
Cell[CellGroupData[{
Cell[805, 29, 156, 3, 67, "Section",ExpressionUUID->"59b85b90-8a42-43af-8d47-2f3d0733b3f7"],
Cell[964, 34, 492, 11, 372, "Input",ExpressionUUID->"b035c77b-6442-4827-b9af-93517f39f522",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1481, 49, 303, 6, 44, "Input",ExpressionUUID->"65c645d3-3bf4-48cd-a1de-13e1d5da5aed",
 InitializationCell->True],
Cell[1787, 57, 702, 12, 32, "Output",ExpressionUUID->"f631c3c3-bc8a-41c5-b5ff-3b3678d0d168"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2526, 74, 384, 9, 44, "Input",ExpressionUUID->"a4b1abfb-99b6-4732-95da-1bb6800a5599",
 InitializationCell->True],
Cell[2913, 85, 275, 6, 32, "Output",ExpressionUUID->"339b8331-630d-4c48-8831-d6a75a9ae4b9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3225, 96, 308, 7, 44, "Input",ExpressionUUID->"3b54a300-6319-4f51-aec9-e2a0a0370e0c",
 InitializationCell->True],
Cell[3536, 105, 634, 11, 32, "Output",ExpressionUUID->"aa73e7ac-cb69-47cc-861b-c0222dbf41fb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4207, 121, 1419, 36, 44, "Input",ExpressionUUID->"29108642-6338-4e49-b705-5f02f71b74c4",
 InitializationCell->True],
Cell[5629, 159, 5053, 151, 71, "Output",ExpressionUUID->"0c8467d7-b2ce-4c99-8caf-81927cef1a47"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[10731, 316, 178, 3, 67, "Section",ExpressionUUID->"d6391d24-e378-4245-aff4-5441ee6bea09"],
Cell[CellGroupData[{
Cell[10934, 323, 567, 14, 44, "Input",ExpressionUUID->"9c1e49c3-c706-41a5-ac5b-5d7550ae7661",
 InitializationCell->True],
Cell[11504, 339, 2003, 55, 32, "Output",ExpressionUUID->"600e137c-aca6-47ed-9820-f5e484d6c6dd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13544, 399, 490, 13, 28, "Input",ExpressionUUID->"8a858cce-9594-4fe8-a803-eb70f76799ad"],
Cell[14037, 414, 249, 5, 32, "Output",ExpressionUUID->"1b3f6cf5-ec41-4c91-a503-eb1b326a2925"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14323, 424, 1203, 33, 44, "Input",ExpressionUUID->"f68f00d6-87bb-4e7e-96b5-05a75fa991bb",
 InitializationCell->True],
Cell[15529, 459, 2165, 70, 52, "Output",ExpressionUUID->"92438e3b-4de7-48ca-9038-2a6703bb90ba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17731, 534, 622, 16, 44, "Input",ExpressionUUID->"399ff505-2b0c-4ff9-a2e7-fc1d60f19333",
 InitializationCell->True],
Cell[18356, 552, 10482, 217, 65, "Output",ExpressionUUID->"f749839f-b2b2-451f-8eca-1f281da769e7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28875, 774, 216, 5, 28, "Input",ExpressionUUID->"af2c85bf-ac7c-4db3-ba32-b506fd9324b0"],
Cell[29094, 781, 2542, 57, 301, "Output",ExpressionUUID->"f4de1a17-ff30-49db-bb5c-02dbcaa4c32b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[31685, 844, 215, 4, 67, "Section",ExpressionUUID->"4bbcc620-6a36-47bc-a963-8962f237f50a"],
Cell[CellGroupData[{
Cell[31925, 852, 596, 16, 28, InheritFromParent,ExpressionUUID->"57a96cd7-5ec8-4277-ba23-8e7e0ee91157"],
Cell[32524, 870, 401, 10, 32, "Output",ExpressionUUID->"9849764a-499b-450f-9d65-85d8952e2ea6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32962, 885, 709, 20, 44, "Input",ExpressionUUID->"0631d165-2b4d-4a07-8767-3ab5ba7edef3",
 InitializationCell->True],
Cell[33674, 907, 400, 9, 32, "Output",ExpressionUUID->"07de698c-3584-4867-a9f6-e0ee9746fe26"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[34123, 922, 164, 3, 67, "Section",ExpressionUUID->"ecb6acf0-a44a-418b-8fb7-390aecb47385"],
Cell[CellGroupData[{
Cell[34312, 929, 1135, 24, 64, "Input",ExpressionUUID->"c7f14875-9da7-4594-a1da-0bfb17ddf7b9",
 InitializationCell->True],
Cell[35450, 955, 2510, 71, 52, "Output",ExpressionUUID->"370baba4-866f-4fa5-b3ab-f10aeba6fa5c"],
Cell[37963, 1028, 653, 12, 32, "Output",ExpressionUUID->"ffef41bc-d3c8-46fa-b83c-34e23a46c2ab"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38653, 1045, 711, 18, 44, "Input",ExpressionUUID->"e8592bea-1c33-4558-8613-b25fb7e77dc7",
 InitializationCell->True],
Cell[39367, 1065, 472, 8, 48, "Output",ExpressionUUID->"89237054-8789-4a46-8445-1962b679b79c"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

